name: Download File and Upload to Release

on:
  workflow_dispatch:
    inputs:
      download_url:
        description: '请输入文件下载链接'
        required: true
        type: string

jobs:
  download-and-release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Download file
        run: |
          file_name=$(basename "${{ github.event.inputs.download_url }}")
          echo "file_name=$file_name" >> $GITHUB_ENV
          wget -O "$file_name" "${{ github.event.inputs.download_url }}"

      - name: Create Release and Upload
        uses: softprops/action-gh-release@v1
        with:
          tag_name: v1.0.0
          name: ${{ env.file_name }}
          body: "通过 GitHub Actions 自动下载并上传的文件"
          files: ${{ env.file_name }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
